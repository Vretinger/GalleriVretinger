{% load static %}
{% load i18n %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}Vretinger Gallery{% endblock %}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="{% static 'css/main.css' %}" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/flag-icons.min.css' %}">
    <link href="{% static 'css/booking.css' %}" rel="stylesheet">
    <link href="{% static 'css/home.css' %}" rel="stylesheet">
    <link href="{% static 'css/events.css' %}" rel="stylesheet">
    <link rel="icon" type="image/png" sizes="32x32" href="{% static 'images/logo.png' %}">
    {% block extra_css %}{% endblock %}
</head>
<body>
    <!-- Sticky Navbar -->
  <nav class="navbar navbar-expand-lg sticky-top shadow-sm">
    <div class="d-flex w-100 align-items-center">
      <div class="container-fluid d-flex">
        <a class="navbar-brand" href="/">
          <img src="{% static 'images/logo.png' %}" alt="Logo" height="40" />
        </a>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav ms-auto">
            <li class="nav-item"><a class="nav-link" href="/">{% trans "Home" %}</a></li>
            <li class="nav-item"><a class="nav-link" href="/gallery/">{% trans "Gallery" %}</a></li>
            <li class="nav-item"><a class="nav-link" href="/events/">{% trans "Events" %}</a></li>
            <li class="nav-item"><a class="nav-link" href="/contact/">{% trans "Contact" %}</a></li>
            <li class="nav-item"><a class="nav-link" href="/booking/availability/">{% trans "Host an Event" %}</a></li>
            {% if user.is_authenticated %}
            <!-- Show when logged in -->
            <li class="nav-item">
              <a class="nav-link" href="{% url 'my_bookings' %}">{% trans "My Events" %}</a>
            </li>
            <li class="nav-item">
              <form method="post" action="{% url 'logout' %}">
                {% csrf_token %}
                <button type="submit" class="btn btn-link nav-link">{% trans "Sign out" %}</button>
              </form>
            </li>
          {% else %}
            <!-- Show when not logged in -->
            <li class="nav-item">
              <a class="nav-link" href="{% url 'login' %}">{% trans "Login/Sign up" %}</a>
            </li>
          {% endif %}

            <!-- Language switcher inside collapse for small screens -->
            <li class="nav-item d-lg-none mt-2">
              <div class="dropdown language-switcher">
                <button
                  class="btn btn-secondary dropdown-toggle w-100"
                  type="button"
                  id="languageDropdownSm"
                  data-bs-toggle="dropdown"
                  aria-expanded="false"
                >
                  <span class="fi fi-gb"></span>
                </button>
                <ul
                  class="dropdown-menu"
                  aria-labelledby="languageDropdownSm"
                >
                  <li>
                    <form action="{% url 'set_language' %}" method="post" class="d-inline">
                      {% csrf_token %}
                      <input type="hidden" name="language" value="en" />
                      <button type="submit" class="dropdown-item">
                        <span class="fi fi-gb"></span> English
                      </button>
                    </form>
                  </li>
                  <li>
                    <form action="{% url 'set_language' %}" method="post" class="d-inline">
                      {% csrf_token %}
                      <input type="hidden" name="language" value="sv" />
                      <button type="submit" class="dropdown-item">
                        <span class="fi fi-se"></span> Svenska
                      </button>
                    </form>
                  </li>
                </ul>
              </div>
            </li>
          </ul>
        </div>
      </div>
      <button class="navbar-toggler align-top me-5" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
          <span class="navbar-toggler-icon"></span>
      </button>

      <div class="dropdown language-switcher d-none d-lg-block" style="margin-left:auto; margin-right:0;">
        <button
          class="btn btn-secondary dropdown-toggle"
          type="button"
          id="languageDropdownLg"
          data-bs-toggle="dropdown"
          aria-expanded="false"
        >
          {% if LANGUAGE_CODE == 'en' %}
            <span class="fi fi-gb"></span>
          {% elif LANGUAGE_CODE == 'sv' %}
            <span class="fi fi-se"></span>
          {% else %}
            <span class="fi fi-se"></span> {# fallback #}
          {% endif %}
        </button>
        <ul class="dropdown-menu" aria-labelledby="languageDropdownLg">
          <li>
            <form action="{% url 'set_language' %}" method="post" class="d-inline">
              {% csrf_token %}
              <input type="hidden" name="language" value="en" />
              <button type="submit" class="dropdown-item">
                <span class="fi fi-gb"></span>
              </button>
            </form>
          </li>
          <li>
            <form action="{% url 'set_language' %}" method="post" class="d-inline">
              {% csrf_token %}
              <input type="hidden" name="language" value="sv" />
              <button type="submit" class="dropdown-item">
                <span class="fi fi-se"></span>
              </button>
            </form>
          </li>
        </ul>
      </div>
    </div>
  </nav>

    <!-- Page content -->
    <main>
        {% block content %}{% endblock %}
    </main>

    <footer class="bg-dark text-white py-4">
        <div class="container">
            <div class="row align-items-center">
            
            <div class="col-md-4 text-center text-md-start mb-3 mb-md-0">
                <h5 class="fw-bold">{% trans "Vretinger Gallery" %}</h5>
                <small class="text-muted">A space for artists and creativity</small>
            </div>

            <div class="col-md-4 text-center mb-3 mb-md-0">
                <a href="{% url 'home' %}" class="text-white mx-2">{% trans "Home" %}</a>
                <a href="/events/" class="text-white mx-2">{% trans "Events" %}</a>
                <a href="/contact/" class="text-white mx-2">{% trans "Contact" %}</a>
            </div>

            <div class="col-md-4 text-center text-md-end">
                <small class="text-muted">&copy; {{ now|date:"Y" }} Vretinger Gallery. All rights reserved.</small>
            </div>

            </div>
        </div>
    </footer>


    <!-- Scripts -->
    <script src="{% url 'javascript-catalog' %}"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://upload-widget.cloudinary.com/latest/global/all.js" type="text/javascript"></script>
    <script src="{% static 'js/modal.js' %}"></script>  

     {% block extra_js %}
        <script src="{% static 'js/event_img_uploads.js' %}"></script>
        <script src="{% static 'js/background_upload.js' %}"></script>
        <script src="{% static 'js/preview.js' %}"></script>
        <script src="{% static 'js/event_days.js' %}"></script>
        <script src="{% static 'js/rental.js' %}"></script>
        <script src="{% static 'js/form_validation.js' %}"></script>
     {% endblock %}

  <!-- Generic Dynamic Modal -->
  <div class="modal fade" id="dynamicModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content text-center">
        <div class="modal-header border-0">
          <h5 class="modal-title w-100" id="dynamicModalTitle"></h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body" id="dynamicModalMessage"></div>
        <div class="modal-footer border-0 justify-content-center">
          <button type="button" class="btn btn-primary" data-bs-dismiss="modal">{% trans "Close" %}</button>
        </div>
      </div>
    </div>
  </div>
</body>
</html>
