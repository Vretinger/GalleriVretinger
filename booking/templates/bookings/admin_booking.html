{% extends "base.html" %}
{% load static %}
{% load i18n %}

{% block content %}
<link href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css" rel="stylesheet">
<script>
  const bookedDatesUrl = "{% url 'booked_dates' %}";
</script>
<div class="booking-page container-fluid">
  <div class="booking-container mx-auto col-md-6 col-sm-12 p-4">
    <!-- Steps -->
    <h2>{% trans "Step 1: Select Rental Period" %}</h2>
    <form method="POST" enctype="multipart/form-data">
      {% csrf_token %}
      <input id="rental-range" class="form-control mb-3" placeholder="{% trans 'Select rental start and end' %}">

      <!-- Hidden inputs -->
      <input type="hidden" id="rental_start" name="start_date">
      <input type="hidden" id="rental_end" name="end_date">

      <div id="stage2">
        <h2 class="mb-4">{% trans "Step 2: Select Event Details" %}</h2>

        <input id="event-days" name="event_days" class="form-control mb-2" placeholder="{% trans 'Select event days' %}">
        <div id="per-day-times" class="mb-3"></div>
        <input type="text" id="event-title" name="title" class="form-control mb-2" placeholder="{% trans 'Enter event title' %}">
        <p>Enter a short description that will show on the upcoming event board(required)</p>
        <textarea id="event-ShortDescription" name="ShortDescription" class="form-control mb-4" placeholder="{% trans 'Event short description' %}"></textarea>
        <p>Enter a longer detailed description of your event if someone is intrested to read more about it (Optinal)</p>
        <textarea id="event-LongDescription" name="LongDescription" class="form-control mb-4" placeholder="{% trans 'Event long description' %}"></textarea>
        
        <div class="card mb-4 shadow-sm">
          <div class="form-check m-3">
            <input class="form-check-input" type="checkbox" name="is_drop_in" id="is_drop_in" checked>
            <label class="form-check-label" for="is_drop_in">
              {% trans "This is a drop-in event (no sign-up needed)" %}
            </label>
          </div>
        
          <div class="m-3" id="maxAttendeesWrapper">
            <label for="max_attendees" class="form-label">{% trans "Max Attendees (optional)" %}</label>
            <input type="number" class="form-control" name="max_attendees" id="max_attendees" min="1" placeholder="e.g. 25">
          </div>
        </div>
        <!-- Event Images -->
        <div class="card mb-4 shadow-sm">
          <div class="card-header bg-light">
            <h5 class="mb-0">{% trans "Event preview & Event image upload" %}</h5>
          </div>
          <div class="row" style="min-height: 25vh;">
            <div class="col-12 col-md-7">
              <section id="preview-section" class="p-4 text-center text-md-start">
                <h1 id="preview-title">{% trans "Event Title" %}</h1>
                <p id="preview-ShortDescription">{% trans "Event description will appear here." %}</p>
                <p id="preview-times">{% trans "Event times: Not set" %}</p>
              </section>
            </div>
            <div class="col-12 col-md-5 my-4 mx-2 event-card-wrapper">
              <!-- Large Card (Primary Upload) -->
              <button id="portrait-upload-btn" type="button" class="event-card w-75 h-100 event-card-large">
                  <img id="portrait-preview" src="{% static 'images/UploadRequired.png' %}" 
                      alt="Primary Placeholder" 
                      class="card-placeholder">
              </button>

              <input type="hidden" name="portrait_image_uploaded" id="portrait-image-hidden">

              <!-- Small Card (Secondary Upload) -->
              <button id="event-upload-btn" type="button" class="event-card h-75 event-card-small">
                  <img id="event-preview" src="{% static 'images/UploadNotRequired.png' %}" 
                      alt="Secondary Placeholder" 
                      class="card-placeholder">
              </button>

              <input type="hidden" name="event_image_uploaded" id="event-image-hidden">

            </div>
          </div>
        </div>
        <button 
          id="finishBtn" 
          type="submit" 
          class="btn btn-primary" 
          disabled
        >
          {% trans "Submit" %}
        </button>
        <div id="form-errors" class="mt-3 text-danger"></div>
      </form>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
{% endblock %}
